{
  "name": "apostrophe-people",
  "version": "0.5.24",
  "description": "Staff directories, user accounts and personal profiles for the Apostrophe content management system",
  "main": "index.js",
  "scripts": {
    "test": "./node_modules/mocha/bin/mocha --reporter spec ./test"
  },
  "repository": {
    "type": "git",
    "url": "git@github.com:punkave/apostrophe-people.git"
  },
  "keywords": [
    "blog",
    "apostrophe",
    "cms",
    "people",
    "users",
    "login",
    "punkave"
  ],
  "author": {
    "name": "P'unk Avenue LLC"
  },
  "license": "MIT",
  "dependencies": {
    "async": "0.8.x",
    "lodash": "2.4.x",
    "extend": "~1.1.x",
    "moment": "~2.0.x",
    "password-hash": "~1.2.1",
    "apostrophe-snippets": "~0.5.x",
    "xkcd-pwgen": "0.0.1",
    "nodemailer": "~0.5.6"
  },
  "devDependencies": {
    "apostrophe": "*",
    "mocha": "*",
    "apostrophe-pages": "*",
    "mongodb": "*",
    "express": "*",
    "request": "*"
  },
  "readme": "# apostrophe-people\n\n`apostrophe-people`, together with `apostrophe-groups`, adds staff directories, user accounts and user profiles to the [Apostrophe](http://github.com/punkave/apostrophe) content management system.\n\nA \"person\" is anyone who can either log in, be seen in a personnel directory, or both. \"Users\" are simply people who have the \"login\" box checked and a username and password configured. This follows the MongoDB philosophy of avoiding gratuitous joins between users, profiles, etc.\n\nPeople can be centrally managed via the \"People\" dropdown, and groups of people created via the \"Groups\" dropdown.\n\nIn addition, one can create a \"directory page\" to display a directory of people. For now people are displayed on such pages based on shared tags, however we plan to also give each user an affinity for a specific \"home\" page allowing for easier management of users.\n\nSee the a2 sandbox for a functional example.\n\n## You Also Need Groups\n\nYou'll want to install both the people module and the [groups module](http://github.com/punkave/apostrophe-groups) to use this functionality successfully. Again, see the [a2 sandbox](http://github.com/punkave/apostrophe-sandbox) for a working example.\n\n## The Directory Page\n\nThe directory page presents a directory of groups, which commonly represent departments within an organization. Only groups which are published are shown here.\n\nWhen a site visitor clicks on a group, they are then shown a list of people in that group. Only people who have the \"published\" selector set to \"Yes\" are shown here.\n\nTODO: provide an option to skip straight to a list of people throughout the organization, and make it easy for that to be the default behavior, as on many sites a public list of groups is overkill or secondary to the main alphabetical list of staff members.\n\n## Subclassing and Overriding the Directory Page\n\nThe directory page is implemented by the `apostrophe-groups` module. You'll want to subclass that module, overriding the `index.html` template and perhaps extending or overriding the `show` and `isShow` methods, or overriding the `dispatch` method entirely, as your needs dictate. Currently the people module is able to use the dispatch method of the snippets module without modification for the main list of gropus. This will likely change soon when we introduce ways to skip directly to a list of all people in the organization.\n\nThis is similar to the way the `apostrophe-events` module subclasses and overrides portions of the `apostrophe-snippets` module.\n\n## About Permissions\n\nPeople receive basic permissions such as \"guest,\" \"edit\" and \"admin\" via groups that have been given those permissions.\n\n### Permission to View Content\n\nPeople who are members of groups for which the \"Admin\" box has been checked can always view everything, whether it is published or not.\n\nPeople who are members of groups for which the \"Guest\" or \"Editor\" box hs been checked has been checked can potentially view additional content:\n\n* Guests and editors can view any page for which \"Login Required\" has been chosen from the \"who can view this?\" section of \"Page Settings.\"\n\n* Guests and editors are candidates to view pages for which \"Certain People\" has been chosen from the \"who can view this?\" section of \"Page Settings.\" An admin must grant them that permission as an individual or as a group after selecting \"Certain People.\"\n\n* In addition, editors can always view content they have permission to edit, as described below.\n\n### Permission to Edit Content\n\nSimilarly, people who are members of groups for which the \"Editor\" box is checked become candidates to edit pages. Someone with admin permissions can then click \"Who can edit this?\" under \"Page Settings\" and enter that person or group's name to add them to the list of editors for that particular page.\n\nThose with editing permissions can also create and edit their own blog posts, events and so forth (but not people or groups). They cannot edit blog posts and events created by others (TODO: allow permissions to be granted for this in the same way edit permissions for pages are granted).\n\n### Admin Permissions\n\nOnly people who are members of groups for which the \"Admin\" box is checked, and any hard-coded admin users in `app.js`, are permitted to carry out admin actions such as:\n\n* Adding people\n* Adding groups\n* Changing and edit and view permissions.\n\n### Sorting People Manually Within A Group\n\nMany organizations have their own way of ranking people within groups or departments that must be maintained. By default, the members of a group are displayed alphabetically. However, you can switch to manual ordering by passing a simple option when initializing the groups module. Here's an example from `app.js`:\n\n    function initAposGroups(callback) {\n      groups = require('apostrophe-groups')({\n        ... other options ...\n        peopleSortable: true\n      }, ... etc ...);\n    }\n\nOnce you enable this option, you will be able to drag and drop people to reorder them in the list of persons that are members of each group.\n\n### Password Reset\n\nUsers may reset their password via email confirmation, as long as they have a valid email address and a link to \"/apos-people/reset-request\" is present in the `login.html` template, which is true in current versions of the sandbox.\n\nHowever for those emails to be delivered you will need to set a valid \"from\" address when configuring the people module. Its options must include:\n\n```javascript\n    {\n      email: {\n        from: \"Some Person <someone@somewhere.com>\"\n      }\n    }\n```\n\nThere is a default \"from\" address but sendmail will complain that it is not valid and users will see an error. So make sure you configure that.\n\n### Profiles\n\nAll users who belong to a group with at least \"guest\" access may edit their profile as long as you include the relevant markup in `outerLayout.html` (see the sandbox for an example).\n\nYou may choose the fields that are editable by the end user via the `profileFields` option. The first name, last name, and title fields are independent of the schema, but if you do not present them in the form they will not be overwritten when the profile is saved. You can customize the form by copying `profileEditor.html` from the people module to `lib/modules/apostrophe-people/profileEditor.html`.\n\n### Applying For Accounts\n\nPeople may apply for accounts with login privileges if you set the `apply` option to `true` when configuring the `apostrophe-people` module.\n\nThe `applyFields` option determines the fields that people are invited to fill out when they apply for an account. The following list is the default, and you should specify at least these fields. You may specify additional fields that exist in your schema (see `addFields`).\n\n```javascript\n[ 'username', 'password', 'firstName', 'lastName', 'title', 'email' ]\n```\n\nThe above fields are required and the user will not be permitted to complete the application form without supplying them.\n\nThe `apply.html` template is used to present the application form.\n\n#### Triggering the Application Form\n\nYou can trigger the application form by giving any link a\n`data-people-apply` attribute. You can place those wherever it makes\nsense in your application:\n\n    <a href=\"#\" data-people-apply>Sign Up For An Account</a>\n\nBy default the user is required to confirm their account by clicking\non a link in an email generated when they complete the form.\n\n### Account Confirmation\n\nConfirmation emails are generated via the `applyEmail.html` and `applyEmail.txt` templates. The subject lines can be overridden via the `applySubject` option.\n\nIf you don't mind a higher rate of spam accounts, you may opt out of\nemail confirmation with:\n\n    applyConfirm: false\n\n### Permissions for New Accounts\n\nWhen users create accounts, by default they are added to a group\ncalled \"Guests\" with the single permission \"guest\". This account is\ncreated if it does not yet exist. If it does already exist, its\npermissions are left as-is.\n\nYou may change the group name:\n\n    applyGroup: guitarists\n\nOr the group's permissions:\n\n    applyGroupPermissions: [ 'guest', 'submit-event', 'submit-blog-post' ]\n\n### Fine-Grained Permissions For Events, Blog Posts and Other Types\n\nFine-grained permissions are now available on a per-group basis for\nevents, blog posts and so on; in fact, any new snippet instance type\nyou define will automatically have three permissions available to be\nassigned to groups:\n\n`submit-blog-post`: can submit a blog post but cannot mark it published\n`edit-blog-post`: can submit blog posts and publish them, but not edit\nother people's\n`admin-blog-post`: can edit, publish and remove any blog post\n\nThis is very helpful to cut down on confusion that stems from giving\ntoo many people the admin permission.\n\nThe \"edit\" permission implies all \"edit-*\" permissions, and the\n\"admin\" permission implies all \"admin-*\" permissions.\n\n### Requiring Users To Log In *Or* Sign In\n\nYou can also set up links that give the user a choice between creating\nan account and logging into an existing account. And you can set a URL\nto be accessed when the user has finished logging in, one way or the\nother, via the data-after-login attribute:\n\n    <a href=\"#\" data-people-login-or-apply data-after-login=\"/\">Log in\nfirst, then go home</a>\n\n### Triggering Button Clicks After The User Logs In\n\nOf course, sometimes what you really want is to force the user to log\nin or sign up, then trigger something that would normally be accessed\nby just clicking a button on a particular page.\n\nSo we've added a way to trigger a click event on an element in a page\nafter loading it. (This is actually a core Apostrophe module feature but it has special relevance here.)\n\nJust end any URL with this:\n\n    #click-my-button\n\nAnd Apostrophe will look for an element with a `data-my-button`\nattribute and trigger a click event on it after loading the relevant page with an extra URL component to prevent caching.\n\n*my-button is just an example. Use your own attribute name.*\n\nApostrophe will also scroll to ensure that element is visible.\n\nThis feature works well with the \"data-after-login\" attribute shown above.\n\n### Using Account Signups With apostrophe-moderator\n\nYou may want to mix this feature with the [apostrophe-moderator](http://github.com/punkave/apostrophe-moderator) module, which allows for easy management of user-submitted content. If so, make sure you add the appropriate permissions for the types that will support moderation, like this:\n\n    applyGroupPermissions: [ 'guest', 'submit-event', 'submit-blog-post' ]\n\nNote the use of hyphenated names.\n\nNow users who create accounts via the online application process will be able to immediately begin submitting and editing their own content, but will *not* be able to mark it as \"published,\" and if you use the moderator module there will be an easy way for admins to filter and view the submitted content.\n\n",
  "readmeFilename": "README.md",
  "bugs": {
    "url": "https://github.com/punkave/apostrophe-people/issues"
  },
  "homepage": "https://github.com/punkave/apostrophe-people",
  "_id": "apostrophe-people@0.5.24",
  "_from": "apostrophe-people@0.5.x"
}
